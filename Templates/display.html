{% extends 'base.html' %}

{% block content %}
    <form class="form-inline">
      <div class="form-group">
        <label class="sr-only" for="nameInput">Disease</label>
        <input type="text" class="form-control" id="diseaseInput" placeholder="First Name">
      </div>
      <button type="submit" class="btn btn-default">Submit</button>
    </form>
    <div class="container"></div>
    <script src="{{ url_for('static', filename='jquery.js') }}" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.js" type="text/javascript"></script>
    <canvas id="myChart" width="400" height="200"></canvas>
    <script>
    //function for creating the graph
    function graph_creation_count(A,C,T,G){
        var ctx = document.getElementById('myChart').getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['A','C','T','G'],
                datasets: [{
                    label: '# of occurrences of DNA',
                    data: [A,C,T,G],
                    backgroundColor: [
                        'rgb(0,0,0)',
                        'rgb(0,0,0)',
                        'rgb(0,0,0)',
                        'rgb(0,0,0)'
                    ],
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
    }
    </script>
	<script type="text/javascript">
        (function ($) {
              $(document).ready(function(){

                    //checking if the form is submitted
                    $('form').on('submit', function(event) {
                        $.ajax({

                            //sending user inserted data to Flask
                            data : {
                                disease: $('#diseaseInput').val()
                            },
                            type: 'POST',
                            url:'/display/data'
                        })
                        .done(function(data) {

                            //creating the graph
                            graph_creation_count(data.DNA_Count.A, data.DNA_Count.C, data.DNA_Count.T, data.DNA_Count.G)                        
                        })
                        event.preventDefault();      
                    });
              });
        })(jQuery);
    </script>
{% endblock %}